{"ast":null,"code":"import{useState}from\"react\";import{useForm}from\"react-hook-form\";import{useNavigate}from\"react-router-dom\";import{useDispatch}from\"react-redux\";import axios from\"axios\";import{login}from\"../redux/slices/userSlice\";import{toast}from\"react-toastify\";const useLogin=()=>{const{register,handleSubmit,formState:{errors},reset}=useForm();const[loginError,setLoginError]=useState(null);const navigate=useNavigate();const dispatch=useDispatch();const onSubmit=async data=>{try{const response=await axios.post(\"https://movies-explorer-mern.onrender.com/api/v1/login\",data);if(response.data.success){const{user,token}=response.data;setLoginError(null);dispatch(login({id:user._id,name:user.name,email:user.email,phone:user.phone,token}));localStorage.setItem(\"authToken\",token);localStorage.setItem(\"userDetails\",JSON.stringify(user));navigate(\"/\");toast.success(\"Login Successfully\");}else{setLoginError(response.data.message||\"Login failed. Please try again.\");}}catch(err){console.error(err);setLoginError(\"An error occurred during login\");}};return{register,handleSubmit,onSubmit,errors,loginError};};export default useLogin;","map":{"version":3,"names":["useState","useForm","useNavigate","useDispatch","axios","login","toast","useLogin","register","handleSubmit","formState","errors","reset","loginError","setLoginError","navigate","dispatch","onSubmit","data","response","post","success","user","token","id","_id","name","email","phone","localStorage","setItem","JSON","stringify","message","err","console","error"],"sources":["/home/mohdadil/Desktop/MERN/movies-explorer-mern/frontend/src/hooks/useLogin.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { login } from \"../redux/slices/userSlice\";\nimport { toast } from \"react-toastify\";\nimport { LoginFormInputs } from \"../utils/interface/types\";\n\nconst useLogin = () => {\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    reset,\n  } = useForm<LoginFormInputs>();\n  const [loginError, setLoginError] = useState<string | null>(null);\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n\n  const onSubmit = async (data: LoginFormInputs) => {\n    try {\n      const response = await axios.post(\n        \"https://movies-explorer-mern.onrender.com/api/v1/login\",\n        data\n      );\n      if (response.data.success) {\n        const { user, token } = response.data;\n        setLoginError(null);\n        dispatch(\n          login({\n            id: user._id,\n            name: user.name,\n            email: user.email,\n            phone: user.phone,\n            token,\n          })\n        );\n        localStorage.setItem(\"authToken\", token);\n        localStorage.setItem(\"userDetails\", JSON.stringify(user));\n        navigate(\"/\");\n        toast.success(\"Login Successfully\");\n      } else {\n        setLoginError(\n          response.data.message || \"Login failed. Please try again.\"\n        );\n      }\n    } catch (err) {\n      console.error(err);\n      setLoginError(\"An error occurred during login\");\n    }\n  };\n\n  return {\n    register,\n    handleSubmit,\n    onSubmit,\n    errors,\n    loginError,\n  };\n};\n\nexport default useLogin;\n"],"mappings":"AAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,OAASC,OAAO,KAAQ,iBAAiB,CACzC,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,KAAQ,aAAa,CACzC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,KAAK,KAAQ,2BAA2B,CACjD,OAASC,KAAK,KAAQ,gBAAgB,CAGtC,KAAM,CAAAC,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CACJC,QAAQ,CACRC,YAAY,CACZC,SAAS,CAAE,CAAEC,MAAO,CAAC,CACrBC,KACF,CAAC,CAAGX,OAAO,CAAkB,CAAC,CAC9B,KAAM,CAACY,UAAU,CAAEC,aAAa,CAAC,CAAGd,QAAQ,CAAgB,IAAI,CAAC,CACjE,KAAM,CAAAe,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAc,QAAQ,CAAGb,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAAc,QAAQ,CAAG,KAAO,CAAAC,IAAqB,EAAK,CAChD,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAf,KAAK,CAACgB,IAAI,CAC/B,wDAAwD,CACxDF,IACF,CAAC,CACD,GAAIC,QAAQ,CAACD,IAAI,CAACG,OAAO,CAAE,CACzB,KAAM,CAAEC,IAAI,CAAEC,KAAM,CAAC,CAAGJ,QAAQ,CAACD,IAAI,CACrCJ,aAAa,CAAC,IAAI,CAAC,CACnBE,QAAQ,CACNX,KAAK,CAAC,CACJmB,EAAE,CAAEF,IAAI,CAACG,GAAG,CACZC,IAAI,CAAEJ,IAAI,CAACI,IAAI,CACfC,KAAK,CAAEL,IAAI,CAACK,KAAK,CACjBC,KAAK,CAAEN,IAAI,CAACM,KAAK,CACjBL,KACF,CAAC,CACH,CAAC,CACDM,YAAY,CAACC,OAAO,CAAC,WAAW,CAAEP,KAAK,CAAC,CACxCM,YAAY,CAACC,OAAO,CAAC,aAAa,CAAEC,IAAI,CAACC,SAAS,CAACV,IAAI,CAAC,CAAC,CACzDP,QAAQ,CAAC,GAAG,CAAC,CACbT,KAAK,CAACe,OAAO,CAAC,oBAAoB,CAAC,CACrC,CAAC,IAAM,CACLP,aAAa,CACXK,QAAQ,CAACD,IAAI,CAACe,OAAO,EAAI,iCAC3B,CAAC,CACH,CACF,CAAE,MAAOC,GAAG,CAAE,CACZC,OAAO,CAACC,KAAK,CAACF,GAAG,CAAC,CAClBpB,aAAa,CAAC,gCAAgC,CAAC,CACjD,CACF,CAAC,CAED,MAAO,CACLN,QAAQ,CACRC,YAAY,CACZQ,QAAQ,CACRN,MAAM,CACNE,UACF,CAAC,CACH,CAAC,CAED,cAAe,CAAAN,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}