{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst initialState = {\n  favorites: [],\n  loading: false,\n  error: null\n};\nexport const fetchFavorites = createAsyncThunk(\"favorites/fetchFavorites\", async (_, {\n  rejectWithValue,\n  getState\n}) => {\n  var _state$user$userDetai;\n  const state = getState();\n  const token = (_state$user$userDetai = state.user.userDetails) === null || _state$user$userDetai === void 0 ? void 0 : _state$user$userDetai.token;\n  try {\n    const response = await axios.get(\"http://localhost:8000/api/v1/getfavorites\", {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return response.data.movies;\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data : error.message);\n  }\n});\n\n// export const addFavorite = createAsyncThunk(\n//   \"favorites/addFavorite\",\n//   async (movie: Movie, { rejectWithValue, getState }) => {\n//     const state: any = getState();\n//     const token = state.user.userDetails?.token;\n\n//     try {\n//       const response = await axios.post(\n//         \"http://localhost:8000/api/v1/addFavorite\",\n//         { params:{movieId: movie._id }},\n//         { headers: { Authorization: `Bearer ${token}` } }\n//       );\n\n//       console.log(\"response from backend\", response.data);\n\n//       return response.data.favorites;\n//     } catch (error: any) {\n//       return rejectWithValue(\n//         error.response ? error.response.data : error.message\n//       );\n//     }\n//   }\n// );\n\nexport const addFavorite = createAsyncThunk(\"favorites/addFavorite\", async (movie, {\n  rejectWithValue,\n  getState\n}) => {\n  var _state$user$userDetai2;\n  const state = getState();\n  const token = (_state$user$userDetai2 = state.user.userDetails) === null || _state$user$userDetai2 === void 0 ? void 0 : _state$user$userDetai2.token;\n  try {\n    const response = await axios.post(`http://localhost:8000/api/v1/addFavorite?movieId=${movie._id}`,\n    // Add movieId as URL parameter\n    {}, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    console.log(\"response from backend\", response.data);\n    return response.data.favorites; // Ensure this is the updated list of favorites\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data : error.message);\n  }\n});\nexport const removeFavorite = createAsyncThunk(\"favorites/removeFavorite\", async (_id, {\n  rejectWithValue,\n  getState\n}) => {\n  var _state$user$userDetai3;\n  const state = getState();\n  const token = (_state$user$userDetai3 = state.user.userDetails) === null || _state$user$userDetai3 === void 0 ? void 0 : _state$user$userDetai3.token;\n  try {\n    const response = await axios.post(`http://localhost:8000/api/v1/removeFavorite?movieId=${_id}`, {}, {\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    return {\n      _id\n    };\n  } catch (error) {\n    return rejectWithValue(error.response ? error.response.data : error.message);\n  }\n});\nconst favoritesSlice = createSlice({\n  name: \"favorites\",\n  initialState,\n  reducers: {},\n  extraReducers: builder => {\n    builder.addCase(fetchFavorites.pending, state => {\n      state.loading = true;\n    }).addCase(fetchFavorites.fulfilled, (state, action) => {\n      state.loading = false;\n      state.favorites = action.payload;\n    }).addCase(fetchFavorites.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    }).addCase(addFavorite.pending, state => {\n      state.loading = true;\n    }).addCase(addFavorite.fulfilled, (state, action) => {\n      state.loading = false;\n      state.favorites = action.payload;\n    }).addCase(addFavorite.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    }).addCase(removeFavorite.pending, state => {\n      state.loading = true;\n    }).addCase(removeFavorite.fulfilled, (state, action) => {\n      state.loading = false;\n      const removedImdbID = action.payload;\n      console.log(removedImdbID);\n      state.favorites = state.favorites.filter(movie => movie._id !== removedImdbID);\n    }).addCase(removeFavorite.rejected, (state, action) => {\n      state.loading = false;\n      state.error = action.payload;\n    });\n  }\n});\nexport default favoritesSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","initialState","favorites","loading","error","fetchFavorites","_","rejectWithValue","getState","_state$user$userDetai","state","token","user","userDetails","response","get","headers","Authorization","data","movies","message","addFavorite","movie","_state$user$userDetai2","post","_id","console","log","removeFavorite","_state$user$userDetai3","favoritesSlice","name","reducers","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","removedImdbID","filter","reducer"],"sources":["/home/mohdadil/Desktop/MERN/movies-explorer-mern/frontend/src/redux/slices/favoritesSlice.tsx"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { Movie } from \"../../utils/interface/types\";\n\ninterface FavoritesState {\n  favorites: Movie[];\n  loading: boolean;\n  error: string | null;\n}\n\nconst initialState: FavoritesState = {\n  favorites: [],\n  loading: false,\n  error: null,\n};\n\nexport const fetchFavorites = createAsyncThunk(\n  \"favorites/fetchFavorites\",\n  async (_, { rejectWithValue, getState }) => {\n    const state: any = getState();\n    const token = state.user.userDetails?.token;\n\n    try {\n      const response = await axios.get(\n        \"http://localhost:8000/api/v1/getfavorites\",\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n\n      return response.data.movies; \n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\n// export const addFavorite = createAsyncThunk(\n//   \"favorites/addFavorite\",\n//   async (movie: Movie, { rejectWithValue, getState }) => {\n//     const state: any = getState();\n//     const token = state.user.userDetails?.token;\n\n//     try {\n//       const response = await axios.post(\n//         \"http://localhost:8000/api/v1/addFavorite\",\n//         { params:{movieId: movie._id }},\n//         { headers: { Authorization: `Bearer ${token}` } }\n//       );\n\n//       console.log(\"response from backend\", response.data);\n\n//       return response.data.favorites;\n//     } catch (error: any) {\n//       return rejectWithValue(\n//         error.response ? error.response.data : error.message\n//       );\n//     }\n//   }\n// );\n\n\nexport const addFavorite = createAsyncThunk(\n  \"favorites/addFavorite\",\n  async (movie: Movie, { rejectWithValue, getState }) => {\n    const state = getState() as any;\n    const token = state.user.userDetails?.token;\n\n    try {\n      const response = await axios.post(\n        `http://localhost:8000/api/v1/addFavorite?movieId=${movie._id}`, // Add movieId as URL parameter\n        {},\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      console.log(\"response from backend\", response.data);\n\n      return response.data.favorites; // Ensure this is the updated list of favorites\n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\n\nexport const removeFavorite = createAsyncThunk(\n  \"favorites/removeFavorite\",\n  async (_id:Movie, { rejectWithValue, getState }) => {\n    const state: any = getState();\n    const token = state.user.userDetails?.token;\n\n    try {\n      const response = await axios.post(\n        `http://localhost:8000/api/v1/removeFavorite?movieId=${_id}`,\n        {},\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      return { _id};\n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\nconst favoritesSlice = createSlice({\n  name: \"favorites\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchFavorites.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(fetchFavorites.fulfilled, (state, action) => {\n        state.loading = false;\n        state.favorites = action.payload;\n      })\n      .addCase(fetchFavorites.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      })\n      .addCase(addFavorite.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(addFavorite.fulfilled, (state, action) => {\n        state.loading = false;\n        state.favorites=action.payload\n      })\n      .addCase(addFavorite.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      })\n      .addCase(removeFavorite.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(removeFavorite.fulfilled, (state, action) => {\n        state.loading = false;\n        const removedImdbID = action.payload;\n        console.log(removedImdbID)\n        state.favorites = state.favorites.filter(\n          (movie) => movie._id !== removedImdbID\n        );\n      })\n      .addCase(removeFavorite.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      });\n  },\n});\n\nexport default favoritesSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}