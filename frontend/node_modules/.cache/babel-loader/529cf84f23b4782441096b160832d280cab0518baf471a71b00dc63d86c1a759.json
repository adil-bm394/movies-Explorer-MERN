{"ast":null,"code":"import{createAsyncThunk,createSlice}from\"@reduxjs/toolkit\";import axios from\"axios\";const initialState={favorites:[],loading:false,error:null};export const fetchFavorites=createAsyncThunk(\"favorites/fetchFavorites\",async(_,_ref)=>{var _state$user$userDetai;let{rejectWithValue,getState}=_ref;const state=getState();const token=(_state$user$userDetai=state.user.userDetails)===null||_state$user$userDetai===void 0?void 0:_state$user$userDetai.token;try{const response=await axios.get(\"https://movies-explorer-mern.onrender.com/api/v1/getfavorites\",{headers:{Authorization:`Bearer ${token}`}});console.log(\"response for getllFAv from backend \",response.data.favorites);return response.data;}catch(error){return rejectWithValue(error.response?error.response.data:error.message);}});export const addFavorite=createAsyncThunk(\"favorites/addFavorite\",async(movie,_ref2)=>{var _state$user$userDetai2;let{rejectWithValue,getState}=_ref2;const state=getState();const token=(_state$user$userDetai2=state.user.userDetails)===null||_state$user$userDetai2===void 0?void 0:_state$user$userDetai2.token;try{const response=await axios.post(\"https://movies-explorer-mern.onrender.com/api/v1/addFavorite\",{imdbID:movie.imdbID},{headers:{Authorization:`Bearer ${token}`}});console.log(\"response backend for addFavourite\",response.data.favorites);return response.data.favorites;}catch(error){return rejectWithValue(error.response?error.response.data:error.message);}});export const removeFavorite=createAsyncThunk(\"favorites/removeFavorite\",async(imdbID,_ref3)=>{var _state$user$userDetai3;let{rejectWithValue,getState}=_ref3;const state=getState();const token=(_state$user$userDetai3=state.user.userDetails)===null||_state$user$userDetai3===void 0?void 0:_state$user$userDetai3.token;try{const response=await axios.post(\"https://movies-explorer-mern.onrender.com/api/v1/removeFavorite\",{imdbID},{headers:{Authorization:`Bearer ${token}`}});return{imdbID};}catch(error){return rejectWithValue(error.response?error.response.data:error.message);}});const favoritesSlice=createSlice({name:\"favorites\",initialState,reducers:{},extraReducers:builder=>{builder.addCase(fetchFavorites.pending,state=>{state.loading=true;}).addCase(fetchFavorites.fulfilled,(state,action)=>{state.loading=false;state.favorites=action.payload;}).addCase(fetchFavorites.rejected,(state,action)=>{state.loading=false;state.error=action.payload;}).addCase(addFavorite.pending,state=>{state.loading=true;}).addCase(addFavorite.fulfilled,(state,action)=>{state.loading=false;state.favorites=action.payload;}).addCase(addFavorite.rejected,(state,action)=>{state.loading=false;state.error=action.payload;}).addCase(removeFavorite.pending,state=>{state.loading=true;}).addCase(removeFavorite.fulfilled,(state,action)=>{state.loading=false;const removedImdbID=action.payload.imdbID;state.favorites=state.favorites.filter(movie=>movie.imdbID!==removedImdbID);}).addCase(removeFavorite.rejected,(state,action)=>{state.loading=false;state.error=action.payload;});}});export default favoritesSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","initialState","favorites","loading","error","fetchFavorites","_","_ref","_state$user$userDetai","rejectWithValue","getState","state","token","user","userDetails","response","get","headers","Authorization","console","log","data","message","addFavorite","movie","_ref2","_state$user$userDetai2","post","imdbID","removeFavorite","_ref3","_state$user$userDetai3","favoritesSlice","name","reducers","extraReducers","builder","addCase","pending","fulfilled","action","payload","rejected","removedImdbID","filter","reducer"],"sources":["/home/mohdadil/Desktop/MERN/movies-explorer-mern/frontend/src/redux/slices/favoritesSlice.tsx"],"sourcesContent":["import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nimport { FavoritesState, Movie, SimplifiedMovie } from \"../../utils/interface/types\";\n\n\nconst initialState: FavoritesState = {\n  favorites: [],\n  loading: false,\n  error: null,\n};\n\nexport const fetchFavorites = createAsyncThunk(\n  \"favorites/fetchFavorites\",\n  async (_, { rejectWithValue, getState }) => {\n    const state: any = getState();\n    const token = state.user.userDetails?.token;\n\n    try {\n      const response = await axios.get(\n        \"https://movies-explorer-mern.onrender.com/api/v1/getfavorites\",\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      console.log(\n        \"response for getllFAv from backend \",\n        response.data.favorites\n      );\n\n      return response.data;\n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\nexport const addFavorite = createAsyncThunk(\n  \"favorites/addFavorite\",\n  async (movie: SimplifiedMovie, { rejectWithValue, getState }) => {\n    const state = getState() as any;\n    const token = state.user.userDetails?.token;\n\n    try {\n      const response = await axios.post(\n        \"https://movies-explorer-mern.onrender.com/api/v1/addFavorite\",\n        { imdbID: movie.imdbID },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n      console.log(\"response backend for addFavourite\", response.data.favorites);\n      return response.data.favorites;\n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\nexport const removeFavorite = createAsyncThunk(\n  \"favorites/removeFavorite\",\n  async (imdbID: string, { rejectWithValue, getState }) => {\n    const state: any = getState();\n    const token = state.user.userDetails?.token;\n\n    try {\n      \n      const response = await axios.post(\n        \"https://movies-explorer-mern.onrender.com/api/v1/removeFavorite\",\n        { imdbID },\n        { headers: { Authorization: `Bearer ${token}` } }\n      );\n\n      return { imdbID };\n    } catch (error: any) {\n      return rejectWithValue(\n        error.response ? error.response.data : error.message\n      );\n    }\n  }\n);\n\nconst favoritesSlice = createSlice({\n  name: \"favorites\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder\n      .addCase(fetchFavorites.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(fetchFavorites.fulfilled, (state, action) => {\n        state.loading = false;\n        state.favorites = action.payload;\n      })\n      .addCase(fetchFavorites.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      })\n      .addCase(addFavorite.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(addFavorite.fulfilled, (state, action) => {\n        state.loading = false;\n        state.favorites = action.payload;\n      })\n      .addCase(addFavorite.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      })\n      .addCase(removeFavorite.pending, (state) => {\n        state.loading = true;\n      })\n      .addCase(removeFavorite.fulfilled, (state, action) => {\n        state.loading = false;\n        const removedImdbID = action.payload.imdbID;\n        state.favorites = state.favorites.filter(\n          (movie) => movie.imdbID !== removedImdbID\n        );\n      })\n      .addCase(removeFavorite.rejected, (state, action) => {\n        state.loading = false;\n        state.error = action.payload as string;\n      });\n  },\n});\n\nexport default favoritesSlice.reducer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}